<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Third Example: Respiratory Binning for Motion-Resolved Cardiac MRI using Superior-Inferior (SI) Projections &#8212; Monalisa 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="_static/custom-navigation.css?v=899df2ba" />
    <link rel="stylesheet" type="text/css" href="_static/custom-button.css?v=35775deb" />
    <link rel="stylesheet" type="text/css" href="_static/important.css?v=8e75c088" />
    <link rel="stylesheet" type="text/css" href="_static/tip.css?v=66ef22ed" />
    <script src="_static/documentation_options.js?v=01f34227"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/custom.js?v=35170ed4"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fourth Example: Cardiac Binning for Motion-Resolved Cardiac MRI using Superior-Inferior (SI) Projections" href="2-4-4_binning_cardiac.html" />
    <link rel="prev" title="Second Example: Task-Based (Hi-Fi) fMRI" href="2-4-2_binning_eye_2.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
  <div role="main">
    
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="third-example-respiratory-binning-for-motion-resolved-cardiac-mri-using-superior-inferior-si-projections">
<h1>Third Example: Respiratory Binning for Motion-Resolved Cardiac MRI using Superior-Inferior (SI) Projections<a class="headerlink" href="#third-example-respiratory-binning-for-motion-resolved-cardiac-mri-using-superior-inferior-si-projections" title="Link to this heading">¶</a></h1>
<p>The present respiratory binning procedure is implemented in the script <cite>lineMask_resp_fromSI_script.m</cite>.
It returns a list of masks (one mask per bin) as a binary array of size <cite>[nBin, nLines]</cite> where <cite>nLines</cite> is
the total number of acquired lines in the sequence.</p>
<p>Each mask corresponds to a respiratory phase extracted from the superior inferior (SI) projections
acquired as the first line of each shot of a 3D-radial free running sequence <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<p>In order to run the scripts, the SI’s must be prepared in an array named <cite>SI</cite> of size <cite>[nCh, N, nShot]</cite>
where <cite>nCh</cite> is the number of channels in the raw data, <cite>N</cite> is the number of points per acquired line,
and <cite>nShot</cite> is the total number of shots acquired during the sequence. We describe here
each section of the script.</p>
<section id="steps-for-respiratory-binning-using-si-projections">
<h2>Steps for Respiratory Binning using SI projections:<a class="headerlink" href="#steps-for-respiratory-binning-using-si-projections" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p><strong>Initialization</strong></p>
<p>Here we set some parameters to help the program to recognize correct sizes
and to inform the rest of the procedure. Enter the requested parameters
as described more in detail below. You can then run the section.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% Initialization</span>

<span class="n">filter_type</span><span class="w">                 </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;lowPass&#39;</span><span class="p">;</span>
<span class="w">                              </span><span class="c">% &#39;lowPass&#39;  for respiratory binning</span>

<span class="n">nMask</span><span class="w">                       </span><span class="p">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="n">maskWidth</span><span class="w">                   </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">% a with of 1 expresses no overlap.</span>
<span class="n">nSignal_to_select</span><span class="w">           </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">% 1 manually, untrended,</span>
<span class="w">                                 </span><span class="c">% selected signal for resp.</span>
<span class="w">                                 </span><span class="c">% binning</span>

<span class="n">signal_exploration_level</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;medium&#39;</span><span class="p">;</span>
<span class="w">                              </span><span class="c">% &#39;leight&#39; or &#39;medium&#39;</span>
<span class="w">                              </span><span class="c">% or &#39;heavy&#39;</span>

<span class="n">nCh</span><span class="w">                         </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="n">N</span><span class="w">                           </span><span class="p">=</span><span class="w"> </span><span class="mi">384</span><span class="p">;</span>
<span class="n">nSeg</span><span class="w">                        </span><span class="p">=</span><span class="w"> </span><span class="mi">22</span><span class="p">;</span>
<span class="n">nShot</span><span class="w">                       </span><span class="p">=</span><span class="w"> </span><span class="mi">3870</span><span class="p">;</span>

<span class="n">nLine</span><span class="w">                       </span><span class="p">=</span><span class="w"> </span><span class="n">nSeg</span><span class="o">*</span><span class="n">nShot</span><span class="p">;</span>
<span class="n">nPt</span><span class="w">                         </span><span class="p">=</span><span class="w"> </span><span class="n">N</span><span class="o">*</span><span class="n">nLine</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><cite>filter_type</cite> must be set to <cite>lowPass</cite> for respiratory binning.</p></li>
<li><p><cite>nMask</cite> is the number of masks (or bins) that we want in the output.</p></li>
<li><p><cite>maskWidth</cite> expresses how much the bins can overlap between neighbors. A value of 1 expresses no overlap. A value of 1.2 expresses 20% overlap.</p></li>
<li><p><cite>signal_exploration_level</cite> is irrelevant for respiratory binning. It is needed for cardiac binning.</p></li>
<li><p><cite>nCh</cite> is the number of channels in the raw data.</p></li>
<li><p><cite>N</cite> is the number of points per acquired lines.</p></li>
<li><p><cite>nSeg</cite> is the number of segments per shot in the sequence.</p></li>
<li><p><cite>nShot</cite> is the total number of acquired shots in the sequence.</p></li>
</ul>
</li>
<li><p><strong>Constructing root-mean-squared SI for display</strong></p>
<p>This section requires no input.
It is just evaluating the root-mean-squared SI’s for a display purpose.
You can just run the section.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% getting rmsSI from SI</span>

<span class="n">rmsSI</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bmMriPhi_fromSI_rmsSI</span><span class="p">(</span><span class="n">SI</span><span class="p">,</span><span class="w"> </span><span class="n">nCh</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">nShot</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p><strong>Extracting one single Reference Signal for Respiratory Binning</strong></p>
<p>The goal of this section is to extract a single reference physiological
signal that will serve to perform the respiratory binning.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% getting standart_reference_signal from SI</span>

<span class="p">[</span><span class="n">s_ref</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">t_ref</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">Fs_ref</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">nu_ref</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">imNav</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">ind_shot_min</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">ind_shot_max</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">ind_SI_min</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">ind_SI_max</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">s_reverse_flag</span><span class="w">   </span><span class="s">]</span><span class="w"> </span><span class="p">=</span><span class="k">...</span>
<span class="n">bmMriPhi_fromSI_get_standart_reference_signal</span><span class="p">(</span><span class="n">rmsSI</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                              </span><span class="n">nCh</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                              </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                              </span><span class="n">nSeg</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                              </span><span class="n">nShot</span><span class="p">);</span>
</pre></div>
</div>
<p>Run the section and you will see a graphical interface appear.
You should be able to recognize the respiratory pattern.</p>
<a class="reference internal image-reference" href="_images/ref_signal_1.png"><img alt="Graphical Interface to Select the Reference Signal" class="align-center" src="_images/ref_signal_1.png" style="width: 90%;" />
</a>
<p>You need now to define 3 pairs of lines by 6 clicks (and some possible re-adjustments)
and then close the window to terminate the section.</p>
<p>The first pair of lines is to define a horizontal window.</p>
<blockquote>
<div><ul class="simple">
<li><p>Do <cite>s + Left Click</cite> to set the left end of the window.</p></li>
<li><p>Do <cite>s + Right Click</cite> to set the right end of the window.</p></li>
</ul>
</div></blockquote>
<p>The program is going to construct internally the even extension
of the reference signal extracted by the present section. Observe
next figure to select the left and right end of the horizontal
window so that no pathology occurs, if possible (it is not critical
but do your best).</p>
<a class="reference internal image-reference" href="_images/even_extension.png"><img alt="Even Extension and Associated Pathologies" class="align-center" src="_images/even_extension.png" style="width: 90%;" />
</a>
<p>In order to avoid pathologies in the even extension of the reference signal,
we will select the left and right ends (yellow vertical bars) of the
horizontal window either in two maxima of the respiratory pattern, or in two minima.
You can zoom with the loop to click precisely.</p>
<p>Note that the left end of that horizontal window also serve to exclude the
non-steady-state data lines.</p>
<p>Here is an example of the selection for the left and right ends of the horizontal
window.</p>
<a class="reference internal image-reference" href="_images/left_end.png"><img alt="Left end of horiozntal window" class="align-center" src="_images/left_end.png" style="width: 90%;" />
</a>
<a class="reference internal image-reference" href="_images/right_end.png"><img alt="Right end of horiozntal window" class="align-center" src="_images/right_end.png" style="width: 90%;" />
</a>
<p>You have now to define the lower and upper bound of the vertical window that
contains some characteristic pattern of respiration. The best way to do it
is to select some vertical window that seems to contain some respiratory pattern
and then adjust it as described below. Make two clicks as follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>Do <cite>x + Left Click</cite> to set the lower bound of the window.</p></li>
<li><p>Do <cite>x + Right Click</cite> to set the upper end of the window.</p></li>
</ul>
</div></blockquote>
<p>After the first click you shou see something like this:</p>
<a class="reference internal image-reference" href="_images/lower_bound.png"><img alt="Lower bound vertical window" class="align-center" src="_images/lower_bound.png" style="width: 90%;" />
</a>
<p>And after the second click you shou see something like that:</p>
<a class="reference internal image-reference" href="_images/upper_bound.png"><img alt="Upper bound vertical window" class="align-center" src="_images/upper_bound.png" style="width: 90%;" />
</a>
<p>The red line is the reference signal generated from the selected windows.
It is a weighted average of the grey values in the vertical window.
You have now to adjust it:</p>
<blockquote>
<div><ul class="simple">
<li><p>press the up-arrow to shift the vertical window up,</p></li>
<li><p>press the down-arrow to shift the vertical window down,</p></li>
<li><p>press the ctrl+right-arrow to increase the width of vertical window,</p></li>
<li><p>press the ctrl+left-arrow to decrease the width of vertical window,</p></li>
</ul>
</div></blockquote>
<a class="reference internal image-reference" href="_images/ref_signal_2.png"><img alt="ref_signal_2" class="align-center" src="_images/ref_signal_2.png" style="width: 90%;" />
</a>
<p>You can also</p>
<blockquote>
<div><ul class="simple">
<li><p>press ctrl+up-arrow to increase the displayed amplitude of the reference signal,</p></li>
<li><p>press ctrl+down-arrow to decrease the displayed amplitude of the reference signal.</p></li>
<li><p>press ctrl+R to flip up-down the reference signal.</p></li>
</ul>
</div></blockquote>
<p>After playing with those adjustments, you may be able to end up with something
similar like the next figure.</p>
<a class="reference internal image-reference" href="_images/ref_signal_3.png"><img alt="ref_signal_3" class="align-center" src="_images/ref_signal_3.png" style="width: 90%;" />
</a>
<p>Finally, chose a vertical window that will serve for display purpose
only in the rest of the procedure.</p>
<blockquote>
<div><ul class="simple">
<li><p>press n + left-click to select the lower bound of the display window,</p></li>
<li><p>press n + right-click to select the upper bound of the display window.</p></li>
</ul>
</div></blockquote>
<p>After the first click you shou see something like this:</p>
<a class="reference internal image-reference" href="_images/ref_signal_4.png"><img alt="ref_signal_4" class="align-center" src="_images/ref_signal_4.png" style="width: 90%;" />
</a>
<p>And after the second click you shou see something like that:</p>
<a class="reference internal image-reference" href="_images/ref_signal_5.png"><img alt="ref_signal_5" class="align-center" src="_images/ref_signal_5.png" style="width: 90%;" />
</a>
<p>You can now close the window and the chosen reference signal will
automatically be saved.</p>
</li>
<li><p><strong>Graphical Frequency Selector</strong></p>
<p>We will now lowpass filter the reference signal. Run the following section.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% graphical frequency selector</span>

<span class="p">[</span><span class="w"> </span><span class="n">s_ref_lowPass</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">s_ref_bandPass</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">lowPass_filter</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="n">bandPass_filter</span><span class="w"> </span><span class="s">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span>
<span class="n">bmMriPhi_graphical_frequency_selector</span><span class="p">(</span><span class="n">s_ref</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                      </span><span class="n">t_ref</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                      </span><span class="n">Fs_ref</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                      </span><span class="n">nu_ref</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                      </span><span class="n">imNav</span><span class="p">);</span>
</pre></div>
</div>
<p>You should then see the graphical frequency selector appear. In the left panel is the
frequency spectrum of the reference signal displayed, and the right panel
is the reference signal displayed.
On the left panel, in the upper line of buttons, press the more right button the stretch
the frequency axis to the right until you see a similar picture like the following.</p>
<a class="reference internal image-reference" href="_images/freq_select_1.png"><img alt="freq_select_1" class="align-center" src="_images/freq_select_1.png" style="width: 90%;" />
</a>
<p>Still on the left panel, in the lower line of buttons, on the right, press the “&lt;&lt;&lt;” button
to decrease the value of the maximum frequency of the filter. You may have to press many times
until the effect appears on the displayed range of frequencies. You can also use the buttons
“&lt;&lt;” and “&lt;” to be more precise. Try to identify the peak around the base frequency of
the respiratory signal, and create a lowpass filter that include that peak, like on the
following figure.</p>
<a class="reference internal image-reference" href="_images/freq_select_2.png"><img alt="freq_select_2" class="align-center" src="_images/freq_select_2.png" style="width: 90%;" />
</a>
<p>For respiratory binning, keep the minimum frequency of the filter at 0. We do a lowpass
filter (bandpass will be for cardiac binning).</p>
<p>Then press the button “Filter Signal”.
The filtered signal appears then in blue on the right panel.
You can press “Hide Yelow” to discard the reference signal.</p>
<a class="reference internal image-reference" href="_images/freq_select_3.png"><img alt="freq_select_3" class="align-center" src="_images/freq_select_3.png" style="width: 90%;" />
</a>
<p>You can stretch the time axis in both directions using the “&lt;&lt;&lt;” and “&gt;&gt;&gt;” buttons
and navigate using the “—&gt;” and  “&lt;—” buttons to inspect the filtered
reference signal. Make sure that the signal looks like a sinusoid modulated in
amplitude and frequency, but that no harmonic of the base frequency are expressed.
There should ideally be no ringing in the filtered signal.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/freq_select_4.png"><img alt="freq_select_4" class="align-center" src="_images/freq_select_4.png" style="width: 90%;" />
</a>
</div></blockquote>
<p>If needed, you can re-adjust the filter and press “Filter Signal” again,
until the filtered signal looks like a modulated sinusoid. You can then close
window and the filter will be saved.</p>
<p>Note that you can change the contrast of the background in the right
panel with the imcontrast tool of Matlab by pressing the “imcontrast” button.
But once you have changed the contrast, press the “fix contrast” button, else
changes in contrast will be lost.</p>
</li>
<li><p><strong>Reformatting the Filtered Signal</strong></p>
<p>Just execute the following automatic section.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% reformated_signal_ref</span>
<span class="n">check_image</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rmsSI</span><span class="p">(</span><span class="n">ind_SI_min</span><span class="p">:</span><span class="n">ind_SI_max</span><span class="p">,</span><span class="w"> </span><span class="p">:);</span>
<span class="n">reformated_signal_ref</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span>
<span class="n">bmMriPhi_fromSI_standartSignal_to_reformatedSignal</span><span class="p">(</span><span class="n">s_ref_lowPass</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                                   </span><span class="n">nSeg</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                                   </span><span class="n">nShot</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                                   </span><span class="n">ind_shot_min</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                                   </span><span class="n">ind_shot_max</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                                   </span><span class="n">check_image</span><span class="p">);</span>
</pre></div>
</div>
<p>A figure appears then to show the filtered signal reformatted with the correct size.
You can check on that figure that the filtered signal oscillate together with the
background.</p>
<a class="reference internal image-reference" href="_images/resp_confirm.png"><img alt="resp_confirm" class="align-center" src="_images/resp_confirm.png" style="width: 90%;" />
</a>
<p>You can close that figure and go to the next section.</p>
</li>
<li><p><strong>Looking for Signal Candidates in Order to Create a Phase</strong></p>
<p>This section is important for cardiac binning. It has no effect for the present
respiratory binning. Just run it and go to the next.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% extracting reformated_signal_list from SI</span>
<span class="k">if</span><span class="w"> </span><span class="n">nSignal_to_select</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span>
<span class="w">   </span><span class="n">nSignal_to_select_minus_1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nSignal_to_select</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">   </span><span class="n">reformated_signal_list</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span>
<span class="w">   </span><span class="n">bmMriPhi_fromSI_collect_signal_list</span><span class="p">(</span><span class="n">filter_type</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">t_ref</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">nu_ref</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">SI</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">lowPass_filter</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">bandPass_filter</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">nCh</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">nSeg</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">nShot</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">nSignal_to_select_minus_1</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">signal_exploration_level</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">ind_shot_min</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">ind_shot_max</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">ind_SI_min</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">ind_SI_max</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                       </span><span class="n">s_reverse_flag</span><span class="p">);</span>
<span class="k">else</span>
<span class="w">   </span><span class="n">reformated_signal_list</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span>
<span class="k">end</span>

<span class="n">reformated_signal_list</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                           </span><span class="n">reformated_signal_ref</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                           </span><span class="n">reformated_signal_list</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p><strong>Selecting the Best Candidate Signals</strong></p>
<p>This section is to include and exclude candidate signals for cardiac binning.
In the present case of respiratory binning, we have only one candidate.
You can run section.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% exclude some of the signals manually</span>
<span class="n">final_signal_list</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span>
<span class="n">bmMriPhi_manually_exclude_signal_of_list</span><span class="p">(</span><span class="w"> </span><span class="n">reformated_signal_list</span><span class="w"> </span><span class="p">);</span>
</pre></div>
</div>
<p>A figure appears to display our single candidate signal. Just close the figure.</p>
<a class="reference internal image-reference" href="_images/accept_resp.png"><img alt="accept_resp" class="align-center" src="_images/accept_resp.png" style="width: 90%;" />
</a>
<p>Then accept the signal, and go to the next section.</p>
<a class="reference internal image-reference" href="_images/accept_refuse.png"><img alt="accept_refuse" class="align-center" src="_images/accept_refuse.png" style="width: 40%;" />
</a>
</li>
<li><p><strong>Create the Masks</strong></p>
<p>Here is the last section for respiratory binning. You can run it.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% mask_construction</span>
<span class="n">rMask</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bmMriPhi_magnitude_to_mask</span><span class="p">(</span><span class="n">final_signal_list</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                   </span><span class="n">nMask</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                   </span><span class="n">nSeg</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                   </span><span class="n">nShot</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                   </span><span class="n">ind_shot_min</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                                   </span><span class="n">ind_shot_max</span><span class="p">);</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/resp_mask.png"><img alt="resp_mask" class="align-center" src="_images/resp_mask.png" style="width: 90%;" />
</a>
<p>The binning mask are displayed and stored in the variable rMask. Note that
some first lines are excuded by the masks, in accordance with the choice of the
horizontal window, which was chosen to exclude non-steady state acquired lines
at the beginning of the procedure.</p>
<p>You can then save rMask on the disk for a future purpose.</p>
</li>
</ol>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Piccini D, Littmann A, Nielles-Vallespin S, Zenge MO. Spiral phyllotaxis: The natural way to construct
a 3D radial trajectory in MRI: Spiral Phyllotaxis Radial 3D Trajectory. Magn Reason Med. 2011
Oct;66(4):1049–56.</p>
</aside>
</aside>
</section>
</section>


          </div>
          
        </div>
      </div>  <!-- This includes the original document content -->

    <!-- Back to Top Button -->
    <button onclick="scrollToTop()" id="back-to-top" title="Go to top">↑</button>
  </div>

      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Monalisa</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_quick_start.html">Quick Start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="2_contents.html">Contents</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="2-1_introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-2_reconstruction_calls.html">Reconstruction Calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-3_mitosius_prepare.html">The Mitosius</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="2-4_binning_masks.html">Binning: Flexible Readout Rearrangement</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="2-4-1_binning_eye_1.html">First Example: Sequential Binning</a></li>
<li class="toctree-l3"><a class="reference internal" href="2-4-2_binning_eye_2.html">Second Example: Task-Based (Hi-Fi) fMRI</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Third Example: Respiratory Binning for Motion-Resolved Cardiac MRI using Superior-Inferior (SI) Projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="2-4-4_binning_cardiac.html">Fourth Example: Cardiac Binning for Motion-Resolved Cardiac MRI using Superior-Inferior (SI) Projections</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="2-5_coil_sensitivity_map.html">Coil Sensitivity Map Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-6_prescan_acquisition.html">Acquisition Guidelines for Coil Sensitivity Estimation using Prescans</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-7_volume_elements.html">Volume Elements or Density Compensation</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-8_acquisition_trajectory.html">Trajectory Definition in Monalisa</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-9_raw_data_readers.html">Reading Raw Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="3_examples.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="4_api.html">API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="5_docker.html">Docker for Monalisa</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_ack_contribution.html">Acknowledgment and Authors</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="2_contents.html">Contents</a><ul>
  <li><a href="2-4_binning_masks.html">Binning: Flexible Readout Rearrangement</a><ul>
      <li>Previous: <a href="2-4-2_binning_eye_2.html" title="previous chapter">Second Example: Task-Based (Hi-Fi) fMRI</a></li>
      <li>Next: <a href="2-4-4_binning_cardiac.html" title="next chapter">Fourth Example: Cardiac Binning for Motion-Resolved Cardiac MRI using Superior-Inferior (SI) Projections</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, MatTech Lab.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/2-4-3_binning_respiratory.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>