<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Coil Sensitivity Map Estimation &#8212; Monalisa 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=039e1c02" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=2389946f"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Coil Sensitivity Map Estimation" href="coil_sensitivity_map_yj.html" />
    <link rel="prev" title="Hello Monalisa" href="hello_monalisa.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="coil-sensitivity-map-estimation">
<h1>Coil Sensitivity Map Estimation<a class="headerlink" href="#coil-sensitivity-map-estimation" title="Permalink to this heading">¶</a></h1>
<p>This section covers the estimation of coil sensitivity maps.</p>
<p>## Overview</p>
<p>Coil sensitivity maps are crucial for various MRI applications, including image reconstruction and spatial localization. Estimating these maps accurately allows for improved image quality and quantitative analysis. This section details how coil sensitivity maps are computed using pre-scan images and how to perform this estimation using the <cite>bmCoilSense_prescan_coilSense</cite> function.</p>
<p>## General Method for Computing Coil Sensitivity Maps</p>
<p>In general coil estimation requires several steps:</p>
<ol class="arabic">
<li><p><strong>Acquire Prescan Images</strong>:
- Obtain low-resolution prescan images from each coil. These images capture the coil’s response to a known signal and are used to estimate sensitivity maps.</p></li>
<li><p><strong>Create Composite Image</strong>:
- Compute a composite image using the sum-of-squares method. This method combines the images from all coils to create a single reference image that represents the combined signal.</p>
<div class="math notranslate nohighlight">
\[I_{\text{composite}}(x) = \sqrt{\sum_{i=1}^N |I_i(x)|^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(I_i(x)\)</span> is the image from the <span class="math notranslate nohighlight">\(i\)</span>-th coil and <span class="math notranslate nohighlight">\(N\)</span> is the total number of coils.</p>
</li>
<li><p><strong>Normalize Coil Images</strong>:
- Normalize each coil’s image with respect to the composite image to estimate the coil sensitivity map for each coil.</p>
<div class="math notranslate nohighlight">
\[S_i(x) = \frac{I_i(x)}{I_{\text{composite}}(x)}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_i(x)\)</span> is the sensitivity map for the <span class="math notranslate nohighlight">\(i\)</span>-th coil.</p>
</li>
<li><p><strong>Smoothing and Regularization (Optional)</strong>:
- Apply smoothing to the sensitivity maps to reduce noise and artifacts. This can be done using techniques such as Gaussian filtering.</p>
<div class="math notranslate nohighlight">
\[S_{i,\text{smoothed}}(x) = \text{GaussianFilter}(S_i(x))\]</div>
</li>
</ol>
<p>## Computing Coil Sensitivity Maps Using <cite>bmCoilSense_prescan_coilSense</cite></p>
<p>The <cite>bmCoilSense_prescan_coilSense</cite> function provides a robust method for estimating coil sensitivity maps from pre-scan images. Below is an explanation of how to use this function:</p>
<p>### Function Signature</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>C<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">bmCoilSense_prescan_coilSense</span><span class="p">(</span>x_body, x_surface, m, n_u<span class="p">)</span>
</pre></div>
</div>
<p>see the implementation <a class="reference external" href="https://github.com/MattechLab/monalisa/blob/main/src/bmCoilSense/from_prescan/bmCoilSense_prescan_coilSense.m">here</a>.</p>
<p>### Inputs</p>
<ul class="simple">
<li><p><strong>`x_body`</strong>:
- Type: Numeric array
- Description: Body coil prescan image. Can be 1D, 2D, or 3D. This image is used to estimate the body coil sensitivity.</p></li>
<li><p><strong>`x_surface`</strong>:
- Type: Numeric array
- Description: Surface (array) coil prescan image. Can be 1D, 2D, or 3D. This image is used to estimate the sensitivity maps of the surface coils.</p></li>
<li><p><strong>`m`</strong>:
- Type: Logical array
- Description: Mask segmenting the non-zero signal volume. The dimensions of this mask should match those of the images provided.</p></li>
<li><p><strong>`n_u`</strong>:
- Type: Numeric vector
- Description: Image size excluding channels. For example, <cite>[96, 96]</cite> for a 2D image or <cite>[64, 56, 32]</cite> for a 3D image.</p></li>
</ul>
<p>### Outputs</p>
<ul class="simple">
<li><p><strong>`C`</strong>:
- Type: Numeric array (complex single)
- Description: Estimated coil sensitivity maps for the surface coils. The output array will have the same dimensions as the input images, with an additional dimension for the coils.</p></li>
</ul>
<p>### Description</p>
<ol class="arabic simple">
<li><p><strong>Initialization</strong>:
- The function initializes parameters for the Laplace solver and smoothing process.</p></li>
<li><p><strong>Normalization</strong>:
- It normalizes the body coil image and computes the root mean square (RMS) of the body coil image. This normalization is essential for accurate sensitivity map estimation.</p></li>
<li><p><strong>Estimate Body Coil Sensitivity</strong>:
- The function estimates the body coil sensitivity using pseudo-diffusion and refines it with a Laplace solver. This step provides a reference sensitivity map for the anatomical region.</p></li>
<li><p><strong>Estimate Surface Coil Sensitivity</strong>:
- For each surface coil, the function computes and refines the sensitivity maps using the anatomical reference and pseudo-diffusion method.</p></li>
<li><p><strong>Reshape Output</strong>:
- Finally, the function reshapes the estimated sensitivity maps to match the original dimensions of the input images.</p></li>
</ol>
<p>### Example</p>
<p>Once you have your low resolution images you simply need to run:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Define example inputs</span>
<span class="n">x_body</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span><span class="c">; % Body coil prescan image</span>
<span class="n">x_surface</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span><span class="c">; % Surface coil prescan image</span>
<span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">...</span><span class="c">; % Mask of the signal volume</span>
<span class="n">n_u</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">96</span><span class="p">,</span><span class="w"> </span><span class="mi">96</span><span class="p">];</span><span class="w"> </span><span class="c">% Image size</span>

<span class="c">% Call the function</span>
<span class="n">C</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bmCoilSense_prescan_coilSense</span><span class="p">(</span><span class="n">x_body</span><span class="p">,</span><span class="w"> </span><span class="n">x_surface</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n_u</span><span class="p">);</span>
</pre></div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Monalisa</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Quick Start</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="hello_monalisa.html">Hello Monalisa</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Coil Sensitivity Map Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="coil_sensitivity_map_yj.html">Coil Sensitivity Map Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="mythosis_prepare_data.html">Mythosis: Prepare Your Data for Reconstruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="writing_reconstruction_script.html">Writing Your Reconstruction Script</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="hello_monalisa.html" title="previous chapter">Hello Monalisa</a></li>
      <li>Next: <a href="coil_sensitivity_map_yj.html" title="next chapter">Coil Sensitivity Map Estimation</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2024, Bastien Milani.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/coil_sensitivity_map.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>